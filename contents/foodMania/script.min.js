function getFoodColor(e){if("üí£"===e)return"#ff0055";for(const[t,n]of Object.entries(COLOR_MAP))if(n.includes(e))switch(t){case"red":return"#ff0055";case"orange":return"#ff5e00";case"cyan":return"#00f3ff";case"blue":return"#0044ff";case"purple":return"#bc13fe";case"white":return"#ffffff";case"pink":return"#ff00ff"}return"#ffffff"}function resize(){canvas.width=window.innerWidth,canvas.height=window.innerHeight}function formatTime(e){const t=Math.floor(e/60).toString().padStart(2,"0"),n=(e%60).toString().padStart(2,"0");return`${t}:${n}`}function startTimer(){clearInterval(timerInterval),gameSeconds=0,document.getElementById("timeVal").innerText=UI_STRINGS.DEFAULT_TIME,timerInterval=setInterval(()=>{"PLAYING"===gameState&&(gameSeconds++,document.getElementById("timeVal").innerText=formatTime(gameSeconds))},1e3)}function showMenu(){gameState="MENU",clearInterval(timerInterval),document.getElementById("game-over-screen").classList.add("hidden"),document.getElementById("pause-screen").classList.add("hidden"),document.getElementById("start-screen").classList.remove("hidden"),document.getElementById("hud-content").classList.add("hidden"),document.getElementById("menu-header").classList.remove("hidden"),document.getElementById("social-floating").classList.remove("hidden"),LiquidBackground.resetToMenu(),ensureLoopRunning()}function togglePause(){"PLAYING"===gameState?(gameState="PAUSED",document.getElementById("pause-screen").classList.remove("hidden"),document.getElementById("social-floating").classList.remove("hidden")):"PAUSED"===gameState&&(gameState="PLAYING",document.getElementById("pause-screen").classList.add("hidden"),document.getElementById("social-floating").classList.add("hidden"),ensureLoopRunning())}function initGame(){SoundSystem.init(),score=0,entities=[],particles=[],scorePopups=[],spawnTimer=0,currentLevelIdx=0,comboCount=0,bladeColor="#ffffff",lives=gameSettings.lives,currentSpeedMultiplier="SLOW"===gameSettings.speed?.7:"FAST"===gameSettings.speed?1.3:1;const e=LEVEL_DATA[0];currentGravity=e.gravity,LiquidBackground.setPalette(e.bg),SoundSystem.setLevel(0),SoundSystem.play("levelup"),updateUI(),updateComboUI(),startTimer(),gameState="PLAYING",document.getElementById("start-screen").classList.add("hidden"),document.getElementById("game-over-screen").classList.add("hidden"),document.getElementById("pause-screen").classList.add("hidden"),document.getElementById("hud-content").classList.remove("hidden"),document.getElementById("menu-header").classList.add("hidden"),document.getElementById("social-floating").classList.add("hidden"),ensureLoopRunning()}function gameOver(){gameState="GAMEOVER",clearInterval(timerInterval),score>highScore&&(highScore=score,localStorage.setItem("foodManiaHigh",highScore)),document.getElementById("final-score").innerText=score,document.getElementById("final-highscore").innerText=highScore,document.getElementById("final-time").innerText=formatTime(gameSeconds),document.getElementById("game-over-screen").classList.remove("hidden"),document.getElementById("hud-content").classList.add("hidden"),document.getElementById("social-floating").classList.remove("hidden"),comboEl.style.opacity="0"}function loseLife(){lives!==1/0&&(lives--,updateUI(),SoundSystem.play("bomb"),document.body.style.transform="translate(15px, 15px)",setTimeout(()=>document.body.style.transform="translate(-15px,-15px)",50),setTimeout(()=>document.body.style.transform="translate(0,0)",100),lives<=0&&gameOver())}function addScore(e,t,n,s){score+=e;let o=UI_STRINGS.PLUS_PREFIX+e,i="#fff";s?(o=UI_STRINGS.COMBO_BONUS,i="#ffff00",SoundSystem.play("combo")):SoundSystem.play("slice"),scorePopups.push(new FloatingText(t,n,o,i)),checkLevelUp(),updateUI()}function checkLevelUp(){if(currentLevelIdx>=LEVEL_DATA.length-1)return;const e=LEVEL_DATA[currentLevelIdx+1];if(score>=e.threshold){currentLevelIdx++;const e=LEVEL_DATA[currentLevelIdx];currentGravity=e.gravity,LiquidBackground.setPalette(e.bg),SoundSystem.setLevel(currentLevelIdx),SoundSystem.play("levelup");const t=document.getElementById("level-indicator");t&&(t.style.transform="scale(1.5)",t.style.color="#fff",setTimeout(()=>{t.style.transform="scale(1)",t.style.color="var(--neon-yellow)"},500))}}function updateUI(){document.getElementById("scoreVal").innerText=score,document.getElementById("highScoreVal").innerText=highScore;const e=document.getElementById("level-indicator");e&&(e.innerText=LEVEL_DATA[currentLevelIdx].name);const t=document.getElementById("livesVal");if(lives===1/0)t.innerHTML='<span style="color:var(--neon-cyan); font-size:24px;">'+UI_STRINGS.INFINITY_SYMBOL+"</span>";else{let e="";for(let t=0;t<lives;t++)e+="‚ù§Ô∏è";t.innerHTML=e}}function updateComboUI(e){if(e&&(currentComboLabel=e),comboCount>1){comboEl.style.opacity="1",comboNumEl.innerText=comboCount+"x",comboLabelEl.innerText=currentComboLabel;const e=comboTimer/MAX_COMBO_TIME*100;comboBarEl.style.width=e+"%",comboBarEl.style.background=e>60?"#00ff00":e>30?"#ffff00":"#ff0000",comboNumEl.classList.remove("animate-pop"),comboNumEl.offsetWidth,comboNumEl.classList.add("animate-pop")}else comboEl.style.opacity="0"}function spawnEntity(){let e=SPAWN_RATE_BASE-2*currentLevelIdx;if(currentSpeedMultiplier>1.2&&(e*=.7),e<15&&(e=15),spawnTimer<e)return;spawnTimer=0;const t=Math.random(),n=LEVEL_DATA[currentLevelIdx];let s=.05+.02*currentLevelIdx;"NONE"===gameSettings.bombs&&(s=0),"LOW"===gameSettings.bombs&&(s*=.5),"HIGH"===gameSettings.bombs&&(s=Math.max(.2,2*s));const o=t<s;if(o)entities.push(new Entity("üí£",currentGravity));else{let e=n.items;if(0===e.length){const t=Math.floor(Math.random()*(LEVEL_DATA.length-1));e=LEVEL_DATA[t].items}const t=e[Math.floor(Math.random()*e.length)];entities.push(new Entity(t,currentGravity))}}function createExplosion(e,t,n,s=15){for(let o=0;o<s;o++)particles.push(new Particle(e,t,n))}function distanceToLine(e,t,n,s,o,i){const a=e-n,l=t-s,r=o-n,c=i-s,d=a*r+l*c,m=r*r+c*c;let h,u,E=-1;0!=m&&(E=d/m),E<0?(h=n,u=s):E>1?(h=o,u=i):(h=n+E*r,u=s+E*c);const g=e-h,f=t-u;return Math.sqrt(g*g+f*f)}function checkSlices(){if(mousePath.length<2)return;const e=mousePath[mousePath.length-2],t=mousePath[mousePath.length-1];entities.forEach(n=>{if(!n.active||n.sliced)return;const s=distanceToLine(n.x,n.y,e.x,e.y,t.x,t.y);if(s<n.radius)if(n.sliced=!0,n.active=!1,n.isBomb)createExplosion(n.x,n.y,"#ff0055",30),bladeColor="#ff0055",loseLife(),comboCount=0,updateComboUI("OOPS!");else{const e=getFoodColor(n.symbol);createExplosion(n.x,n.y,e,15),bladeColor=e,comboCount++,comboTimer=MAX_COMBO_TIME;let t=FOOD_NAMES[n.symbol]||"TASTY!";updateComboUI(t);let s=10,o=!1;comboCount>=3&&(s+=5*comboCount,o=!0),addScore(s,n.x,n.y,o)}})}function loop(){if("PAUSED"!==gameState)if(ctx.clearRect(0,0,canvas.width,canvas.height),"GAMEOVER"!==gameState){if("PLAYING"===gameState&&(spawnTimer++,spawnEntity(),comboTimer>0?(comboTimer--,comboCount>1&&updateComboUI()):comboCount>0&&(comboCount=0,updateComboUI()),entities.forEach(e=>{e.update(),e.draw()}),particles.forEach((e,t)=>{e.update(),e.draw(),e.life<=0&&particles.splice(t,1)}),scorePopups.forEach((e,t)=>{e.update(),e.draw(),e.life<=0&&scorePopups.splice(t,1)}),entities=entities.filter(e=>e.active),mousePath.length>1)){for(let e=0;e<mousePath.length-1;e++){const t=mousePath[e],n=mousePath[e+1],s=n.speed||0,o=Math.min(25,Math.max(4,.5*s));ctx.beginPath(),ctx.strokeStyle=bladeColor,ctx.shadowBlur=0,ctx.shadowColor="transparent",ctx.lineWidth=o,ctx.lineCap="round",ctx.lineJoin="round",ctx.moveTo(t.x,t.y),ctx.lineTo(n.x,n.y),ctx.stroke()}mousePath.length>TRAIL_LENGTH&&mousePath.shift(),!isMouseDown&&mousePath.length>0&&mousePath.shift()}animationFrameId=requestAnimationFrame(loop),mousePath.length>=3&&(mousePath.length=3)}else{if(particles.forEach((e,t)=>{e.update(),e.draw(),e.life<=0&&particles.splice(t,1)}),Math.random()<.1){const e=Math.random()*canvas.width,t=Math.random()*canvas.height,n=`hsl(${360*Math.random()}, 100%, 50%)`;createExplosion(e,t,n,20)}animationFrameId=requestAnimationFrame(loop)}}function ensureLoopRunning(){animationFrameId&&cancelAnimationFrame(animationFrameId),loop()}function addPoint(e,t){let n=0;if(mousePath.length>0){const s=mousePath[mousePath.length-1],o=e-s.x,i=t-s.y;n=Math.sqrt(o*o+i*i)}mousePath.push({x:e,y:t,speed:n}),"PLAYING"===gameState&&checkSlices()}const FOOD_NAMES={"ü•¨":"KALE","ü•¶":"BROCCOLI","ü•ï":"CARROT","ü•î":"POTATO","üç†":"YAM","ü´ö":"GINGER","üçÖ":"TOMATO","üçÜ":"EGGPLANT","ü´ë":"PEPPER","ü•í":"CUCUMBER","ü´õ":"PEAS","üåΩ":"CORN","üßÑ":"GARLIC","üßÖ":"ONION","üçÑ":"MUSHROOM","üçè":"APPLE","üçé":"APPLE","üçê":"PEAR","üçä":"ORANGE","üçã":"LEMON","ü•≠":"MANGO","üçç":"PINEAPPLE","ü••":"COCONUT","ü•ù":"KIWI","üçå":"BANANA","üçâ":"MELON","üçà":"MELON","üçì":"BERRY","ü´ê":"BERRY","üçá":"GRAPES","üçí":"CHERRY","üçë":"PEACH","ü•©":"STEAK","üçñ":"MEAT","ü•ì":"BACON","üçó":"CHICKEN","ü•ö":"EGG","üßÄ":"CHEESE","üêü":"FISH","üê†":"FISH","üê°":"PUFFER","ü¶ê":"SHRIMP","üç§":"TEMPURA","ü¶Ä":"CRAB","ü¶û":"LOBSTER","ü¶™":"OYSTER","ü¶ë":"SQUID","üçû":"BREAD","ü•ñ":"BAGUETTE","ü•ê":"CROISSANT","ü•Ø":"BAGEL","ü•û":"PANCAKE","üßá":"WAFFLE","üßà":"BUTTER","ü´ì":"AREPA","ü•™":"SANDWICH","üçî":"BURGER","üçï":"PIZZA","üå≠":"HOTDOG","üåÆ":"TACO","üåØ":"BURRITO","üçü":"FRIES","üçø":"POPCORN","ü•§":"SODA","üç£":"SUSHI","üç±":"BENTO","üçú":"NOODLE","ü•ü":"DUMPLING","üçö":"RICE","üçô":"ONIGIRI","üçò":"CRACKER","üçõ":"CURRY","üç¢":"ODEN","ü•†":"COOKIE","ü•°":"TAKEOUT","üç°":"DANGO","üç©":"DONUT","üç¶":"ICECREAM","üç∞":"CAKE","üéÇ":"CAKE","üç™":"COOKIE","üç´":"CHOCO","üç¨":"CANDY","üç≠":"LOLLIPOP","üßÅ":"CUPCAKE","ü•ß":"PIE","üçÆ":"FLAN","üç∫":"BEER","üçª":"CHEERS","ü•Ç":"CHEERS","üçæ":"CHAMPAGNE","üç∑":"WINE","ü•É":"WHISKY","üç∏":"MARTINI","üçπ":"DRINK","üç∂":"SAKE","‚òï":"COFFEE","üßã":"BOBA","üßâ":"MATE"},COLOR_MAP={red:["üçé","üçì","üçí","üçâ","üçÖ","üå∂Ô∏è","ü•©","ü•ì","ü•ä","üç∑","ü•§","ü•´","üç£","üêô","ü¶û","ü¶Ä"],orange:["üçä","ü•≠","ü•ï","üéÉ","üç§","üçë","üå≠","üçî","üçï","üçù","ü•ê","üçû","ü•ñ","ü•®","ü•û","üßá","üçü","ü•£","üçå","üçã","üßÄ","üåΩ","üçç","üç∫","üçª","üßà","üçØ","üåÆ","üçò","ü•î"],cyan:["ü•¨","ü•¶","ü•í","üçè","ü•ù","üçê","ü´õ","üçà","üçµ","ü•ë","ü´ë","ü•ó","ü§¢","üê¢","üêõ"],blue:["üçá","ü´ê","üçÜ","ü¶ë","üç©","üîÆ","üßø","üåÄ","ü•£","üßä"],purple:["üç†","ü••","üçñ","üçó","ü•ö","ü•Ø","üå∞","üç™","üç´","üßã","üç±","üçõ","üçô","üçö","ü•ü","ü•°","üçÑ","ü•ú","ü•™","ü•ô","üßÜ"],white:["üçô","üçö","ü•õ","üßÇ","ü•°","ü•¢","üçΩÔ∏è","‚òÅÔ∏è","üèê","üëª","ü¶∑","ü¶¥","ü¶¢"],pink:["üç•","üç¶","üçß","üç°","üêñ","üêΩ"]},UI_STRINGS={SCORE:"SCORE",HIGH:"HIGH",TIME:"TIME",LIVES:"LIVES",COMBO:"COMBO",GAME_OVER:"GAME OVER",PAUSED:"PAUSED",START_GAME:"START GAME",RESUME:"RESUME",MENU:"MENU",RETRY:"RETRY",DEFAULT_TIME:"00:00",INFINITY_SYMBOL:"Íùé",LIVES_LABEL:"LIVES",BOMBS_LABEL:"BOMBS",SPEED_LABEL:"SPEED",BOMBS_NONE:"NO",BOMBS_LOW:"LOW",BOMBS_MID:"MID",BOMBS_HIGH:"HI",SPEED_SLOW:"SLOW",SPEED_NORM:"NORM",SPEED_FAST:"FAST",PLUS_PREFIX:"+",COMBO_BONUS:"COMBO!",STAGE_PREFIX:"STAGE"},gameSettings={lives:3,bombs:"LOW",speed:"NORM"};document.querySelectorAll(".toggle-group").forEach(e=>{e.addEventListener("click",t=>{if(t.target.classList.contains("toggle-btn")){e.querySelectorAll(".toggle-btn").forEach(e=>e.classList.remove("active")),t.target.classList.add("active");const n=t.target.getAttribute("data-val"),s=e.id;"opt-lives"===s&&(gameSettings.lives="INF"===n?1/0:parseInt(n)),"opt-bombs"===s&&(gameSettings.bombs=n),"opt-speed"===s&&(gameSettings.speed=n)}})});const LiquidBackground={canvas:document.getElementById("bgCanvas"),ctx:null,time:0,currentColors:[{h:0,s:0,l:0},{h:0,s:0,l:0},{h:0,s:0,l:0},{h:0,s:0,l:0}],targetColors:[{h:0,s:0,l:0},{h:0,s:0,l:0},{h:0,s:0,l:0},{h:0,s:0,l:0}],init:function(){this.ctx=this.canvas.getContext("2d"),this.resize(),window.addEventListener("resize",()=>this.resize()),this.resetToMenu(),this.loop()},resetToMenu:function(){const e=[{h:270,s:100,l:30},{h:190,s:100,l:40},{h:320,s:100,l:40},{h:240,s:100,l:20}];this.setPalette(e),this.currentColors=JSON.parse(JSON.stringify(e))},setPalette:function(e){this.targetColors=JSON.parse(JSON.stringify(e))},resize:function(){this.canvas.width=window.innerWidth/4,this.canvas.height=window.innerHeight/4},lerp:function(e,t,n){return(1-n)*e+n*t},loop:function(){this.time+=.005;for(let e=0;e<4;e++)this.currentColors[e].h=this.lerp(this.currentColors[e].h,this.targetColors[e].h,.02),this.currentColors[e].s=this.lerp(this.currentColors[e].s,this.targetColors[e].s,.02),this.currentColors[e].l=this.lerp(this.currentColors[e].l,this.targetColors[e].l,.02);this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.globalCompositeOperation="screen";const e=this.canvas.width,t=this.canvas.height,n=[0,2,4,1],s=[1,1.2,.8,1.1];for(let o=0;o<4;o++){const i=this.time*s[o],a=(.4*Math.sin(i+n[o])+.5)*e,l=(.4*Math.cos(1.5*i+n[o])+.5)*t,r=.7*e,c=this.currentColors[o],d=this.ctx.createRadialGradient(a,l,0,a,l,r);d.addColorStop(0,`hsla(${c.h}, ${c.s}%, ${c.l}%, 0.8)`),d.addColorStop(1,`hsla(${c.h}, ${c.s}%, 0%, 0)`),this.ctx.fillStyle=d,this.ctx.beginPath(),this.ctx.arc(a,l,r,0,2*Math.PI),this.ctx.fill()}requestAnimationFrame(()=>this.loop())}},SoundSystem={ctx:null,pitchMultiplier:1,init:function(){this.ctx||(this.ctx=new(window.AudioContext||window.webkitAudioContext)),"suspended"===this.ctx.state&&this.ctx.resume()},setLevel:function(e){this.pitchMultiplier=1+.05*e},play:function(e){if(this.ctx)try{const t=this.ctx.createOscillator(),n=this.ctx.createGain();t.connect(n),n.connect(this.ctx.destination);const s=this.ctx.currentTime,o=this.pitchMultiplier;"slice"===e?(t.type="sawtooth",t.frequency.setValueAtTime(800*o,s),t.frequency.exponentialRampToValueAtTime(100,s+.1),n.gain.setValueAtTime(.05,s),n.gain.exponentialRampToValueAtTime(.001,s+.1),t.start(s),t.stop(s+.1)):"combo"===e?(t.type="sine",t.frequency.setValueAtTime(800*o,s),t.frequency.linearRampToValueAtTime(1200*o,s+.1),n.gain.setValueAtTime(.1,s),n.gain.linearRampToValueAtTime(0,s+.3),t.start(s),t.stop(s+.3)):"bomb"===e?(t.type="sawtooth",t.frequency.setValueAtTime(100,s),t.frequency.exponentialRampToValueAtTime(10,s+.5),n.gain.setValueAtTime(.2,s),n.gain.exponentialRampToValueAtTime(.001,s+.5),t.start(s),t.stop(s+.5)):"levelup"===e&&(t.type="triangle",t.frequency.setValueAtTime(300,s),t.frequency.linearRampToValueAtTime(600,s+.2),t.frequency.linearRampToValueAtTime(1200,s+.5),n.gain.setValueAtTime(.1,s),n.gain.linearRampToValueAtTime(0,s+.8),t.start(s),t.stop(s+.8))}catch(e){}}},LEVEL_DATA=[{name:"VEGGIE DIET",threshold:0,gravity:.12,bg:[{h:180,s:100,l:30},{h:220,s:100,l:30},{h:200,s:100,l:20},{h:240,s:100,l:30}],items:["ü•¨","ü•¶","ü•ï","ü•î","üç†","ü´ö","üçÖ","üçÜ","ü´ë","ü•í","ü´õ","üåΩ","üßÑ","üßÖ","üçÑ"]},{name:"FRUIT SALAD",threshold:500,gravity:.14,bg:[{h:300,s:100,l:40},{h:340,s:100,l:40},{h:280,s:100,l:30},{h:320,s:100,l:30}],items:["üçè","üçé","üçê","üçä","üçã","ü•≠","üçç","ü••","ü•ù","üçå","üçâ","üçà","üçì","ü´ê","üçá","üçí","üçë"]},{name:"MEAT BUTCHER",threshold:1200,gravity:.16,bg:[{h:0,s:100,l:30},{h:350,s:100,l:20},{h:10,s:80,l:30},{h:340,s:90,l:20}],items:["ü•©","üçñ","ü•ì","üçó","ü•ö","üßÄ"]},{name:"SEA SALT",threshold:2e3,gravity:.18,bg:[{h:220,s:100,l:40},{h:190,s:100,l:30},{h:240,s:100,l:20},{h:200,s:100,l:40}],items:["üêü","üê†","üê°","ü¶ê","üç§","ü¶Ä","ü¶û","ü¶™","ü¶ë"]},{name:"BAKE GOODIES",threshold:3e3,gravity:.2,bg:[{h:270,s:80,l:30},{h:290,s:80,l:30},{h:250,s:80,l:20},{h:300,s:80,l:30}],items:["üçû","ü•ñ","ü•ê","ü•Ø","ü•û","üßá","üßà","ü´ì","ü•™"]},{name:"FAST LANE",threshold:4200,gravity:.22,bg:[{h:10,s:100,l:40},{h:40,s:100,l:40},{h:0,s:100,l:30},{h:20,s:100,l:30}],items:["üçî","üçï","üå≠","üåÆ","üåØ","üçü","üçø","ü•§"]},{name:"KONICHIWA!",threshold:5600,gravity:.24,bg:[{h:330,s:100,l:30},{h:200,s:100,l:20},{h:300,s:100,l:30},{h:180,s:100,l:20}],items:["üç£","üç±","üçú","ü•ü","üçö","üçô","üçò","üçõ","üç¢","ü•†","ü•°","üç°"]},{name:"SUGAR RUSH",threshold:7200,gravity:.26,bg:[{h:300,s:100,l:50},{h:260,s:100,l:50},{h:320,s:100,l:40},{h:280,s:100,l:40}],items:["üç©","üç¶","üç∞","üéÇ","üç™","üç´","üç¨","üç≠","üßÅ","ü•ß","üçÆ"]},{name:"HAPPY HOUR",threshold:9e3,gravity:.28,bg:[{h:240,s:100,l:20},{h:270,s:100,l:30},{h:220,s:100,l:20},{h:290,s:100,l:20}],items:["üç∫","üçª","ü•Ç","üçæ","üç∑","ü•É","üç∏","üçπ","üç∂","‚òï","üßã","üßâ"]},{name:"THE BANQUET",threshold:12e3,gravity:.3,bg:[{h:0,s:100,l:40},{h:180,s:100,l:40},{h:300,s:100,l:40},{h:60,s:100,l:40}],items:[]}],canvas=document.getElementById("gameCanvas"),ctx=canvas.getContext("2d"),comboEl=document.getElementById("combo-container"),comboNumEl=document.getElementById("combo-num"),comboLabelEl=document.getElementById("combo-label"),comboBarEl=document.getElementById("combo-bar-fill");let gameState="MENU",score=0,highScore=localStorage.getItem("foodManiaHigh")||0,lives=5,entities=[],particles=[],scorePopups=[],spawnTimer=0,mousePath=[],isMouseDown=!1,comboCount=0,comboTimer=0,currentComboLabel="COMBO";const MAX_COMBO_TIME=300;let currentLevelIdx=0,currentGravity=.2;const TRAIL_LENGTH=.025,SPAWN_RATE_BASE=50;let animationFrameId,timerInterval,bladeColor="#ffffff",currentSpeedMultiplier=1,gameSeconds=0;class Entity{constructor(e,t){this.symbol=e,this.x=Math.random()*(canvas.width-100)+50,this.y=canvas.height+80;let n=3*Math.random()+12;currentSpeedMultiplier>1.1&&(n*=1.3),currentSpeedMultiplier<.9&&(n*=.8);const s=this.x<canvas.width/2?1:-1;this.vx=(2*Math.random()+.5)*s,this.vy=-n,this.rotation=0,this.rotationSpeed=.1*(Math.random()-.5),this.sliced=!1,this.active=!0,this.radius=45,this.gravity=t*currentSpeedMultiplier,this.isBomb="üí£"===e}update(){this.active&&(this.x+=this.vx,this.y+=this.vy,this.vy+=this.gravity,this.rotation+=this.rotationSpeed,this.y>canvas.height+100&&!this.sliced&&(this.active=!1,this.isBomb||lives===1/0||loseLife()))}draw(){this.active&&!this.sliced&&(ctx.save(),ctx.translate(this.x,this.y),ctx.rotate(this.rotation),ctx.font="80px serif",ctx.textAlign="center",ctx.textBaseline="middle",ctx.shadowBlur=0,ctx.shadowColor="transparent",ctx.fillText(this.symbol,0,10),ctx.restore())}}class Particle{constructor(e,t,n){this.x=e,this.y=t,this.color=n,this.vx=10*(Math.random()-.5),this.vy=10*(Math.random()-.5),this.life=1,this.size=12*Math.random()+8}update(){this.x+=this.vx,this.y+=this.vy,this.vy+=.3,this.life-=.02}draw(){ctx.save(),ctx.fillStyle=this.color,ctx.shadowBlur=0,this.life<.3&&(ctx.fillStyle="#fff");const e=this.size*this.life;ctx.fillRect(this.x,this.y,e,e),ctx.restore()}}class FloatingText{constructor(e,t,n,s){this.x=e,this.y=t,this.text=n,this.color=s,this.life=1,this.vy=-2}update(){this.y+=this.vy,this.life-=.015}draw(){this.life<=0||(ctx.save(),ctx.fillStyle=this.color,ctx.font="bold 40px monospace",ctx.fillText(this.text,this.x,this.y),ctx.restore())}}window.addEventListener("resize",resize),resize(),LiquidBackground.init(),window.addEventListener("mousedown",e=>{"PLAYING"===gameState&&(isMouseDown=!0,mousePath=[],addPoint(e.clientX,e.clientY),SoundSystem.init(),SoundSystem.play("slice"))}),window.addEventListener("mousemove",e=>{isMouseDown&&addPoint(e.clientX,e.clientY)}),window.addEventListener("mouseup",()=>{isMouseDown=!1,mousePath=[]}),window.addEventListener("touchstart",e=>{"PLAYING"===gameState&&(isMouseDown=!0,mousePath=[],addPoint(e.touches[0].clientX,e.touches[0].clientY),SoundSystem.init(),SoundSystem.play("slice"))},{passive:!1}),window.addEventListener("touchmove",e=>{e.preventDefault(),isMouseDown&&addPoint(e.touches[0].clientX,e.touches[0].clientY)},{passive:!1}),window.addEventListener("touchend",()=>{isMouseDown=!1,mousePath=[]}),window.addEventListener("blur",()=>{"PLAYING"===gameState&&togglePause()}),window.addEventListener("contextmenu",e=>{e.preventDefault(),"PLAYING"===gameState&&togglePause()}),document.getElementById("start-btn").addEventListener("click",()=>initGame()),document.getElementById("restart-btn").addEventListener("click",()=>initGame()),document.getElementById("menu-btn").addEventListener("click",showMenu),window.openModal=function(e){document.getElementById("modal-overlay").classList.remove("hidden"),document.querySelectorAll(".modal-box").forEach(e=>e.classList.add("hidden")),document.getElementById(e).classList.remove("hidden")},window.closeAllModals=function(){document.getElementById("modal-overlay").classList.add("hidden")},window.shareTwitter=function(){const e=formatTime(gameSeconds),t=gameSettings.lives===1/0?"Íùé":gameSettings.lives,n=`I sliced for ${e} and scored ${score} pts in Food Mania! ${gameSettings.speed} mode, ${gameSettings.bombs} bombs, ${t} lives. üçéüî™ Can you beat me?`,s="https://codepen.io/Julibe/pen/wBGjpyL",o="FoodMania,Arcade,Gaming,Highscore",i=`https://twitter.com/intent/tweet?text=${encodeURIComponent(n)}&url=${encodeURIComponent(s)}&hashtags=${encodeURIComponent(o)}`;window.open(i,"_blank")},document.getElementById("highScoreVal").innerText=highScore,ensureLoopRunning();