# --- Core Server Configuration ---
Options -MultiViews

# --- Allow Framing (iframes / embeds) ---
<IfModule mod_headers.c>
    Header always unset X-Frame-Options
    Header always set Content-Security-Policy "frame-ancestors *;"
</IfModule>

# --- Custom Error Documents ---
ErrorDocument 404 /index.php?category=error&error=404
ErrorDocument 400 /index.php?category=error&error=400
ErrorDocument 403 /index.php?category=error&error=403
ErrorDocument 401 /index.php?category=error&error=401
ErrorDocument 500 /index.php?category=error&error=500

# --- Security: Deny Access to Sensitive Areas ---
# Block Directories
RedirectMatch 404 /admin/
RedirectMatch 404 /backups/
RedirectMatch 404 /contents/
RedirectMatch 404 /php/
RedirectMatch 404 /.git/
RedirectMatch 404 /.vscode/
RedirectMatch 404 /.frontmatter/
RedirectMatch 404 /logs/
RedirectMatch 404 /.logs/

# Block Specific Files
RedirectMatch 404 /blacklist.txt
RedirectMatch 404 /config.php
RedirectMatch 404 /Desktop.ini
RedirectMatch 404 /LICENSE
RedirectMatch 404 /README.md
RedirectMatch 404 /scripts/functions.js

# Block Source Files & Logs
<FilesMatch "\.(less|scss|sass|ini|log)$">
    Require all denied
</FilesMatch>

# --- Rewrite Engine ---
RewriteEngine On

# --- Friendly URL Rewrites ---

# Root (Home)
RewriteRule ^$ index.php [L]

# HTML (.html)
# Sample 1: /news/tech/2025.html     (Category / Filter / Slug)
# Sample 2: /products/laptop.html    (Category / Slug)
# Sample 3: /about.html              (Slug)
RewriteRule ^(.*)/(.*)/(.*)\.html$ index.php?category=$1&filter=$2&slug=$3&format=html [QSA,L]
RewriteRule ^(.*)/(.*)\.html$ index.php?category=$1&slug=$2&format=html [QSA,L]
RewriteRule ^(.*)\.html$ index.php?slug=$1&format=html [QSA,L]

# HTM (.htm)
# Sample 1: /html/news/tech/2025.htm
# Sample 2: /html/products/laptop.htm
# Sample 3: /html/contact.htm
RewriteRule ^html/(.*)/(.*)/(.*)\.htm$ index.php?category=$1&filter=$2&slug=$3&format=htm [QSA,L]
RewriteRule ^html/(.*)/(.*)\.htm$ index.php?category=$1&slug=$2&format=htm [QSA,L]
RewriteRule ^html/(.*)\.htm$ index.php?slug=$1&format=htm [QSA,L]

# TXT (.txt)
# Sample 1: /txt/logs/error/today.txt
# Sample 2: /txt/notice/urgent.txt
# Sample 3: /txt/robots.txt
RewriteRule ^txt/(.*)/(.*)/(.*)\.txt$ index.php?category=$1&filter=$2&slug=$3&format=txt [QSA,L]
RewriteRule ^txt/(.*)/(.*)\.txt$ index.php?category=$1&slug=$2&format=txt [QSA,L]
RewriteRule ^txt/(.*)\.txt$ index.php?slug=$1&format=txt [QSA,L]

# JavaScript (.js)
# Sample 1: /script/lib/chart/v2.js
# Sample 2: /script/module/core.js
# Sample 3: /script/app.js
RewriteRule ^script/(.*)/(.*)/(.*)\.js$ index.php?category=$1&filter=$2&slug=$3&format=js [QSA,L]
RewriteRule ^script/(.*)/(.*)\.js$ index.php?category=$1&slug=$2&format=js [QSA,L]
RewriteRule ^script/(.*)\.js$ index.php?slug=$1&format=js [QSA,L]

# JSON (.json)
# Sample 1: /json/api/users/list.json
# Sample 2: /json/data/export.json
# Sample 3: /json/config.json
RewriteRule ^json/(.*)/(.*)/(.*)\.json$ index.php?category=$1&filter=$2&slug=$3&format=json [QSA,L]
RewriteRule ^json/(.*)/(.*)\.json$ index.php?category=$1&slug=$2&format=json [QSA,L]
RewriteRule ^json/(.*)\.json$ index.php?slug=$1&format=json [QSA,L]

# XML (.xml)
# Sample 1: /xml/feed/blog/main.xml
# Sample 2: /xml/sitemap/2025.xml
# Sample 3: /xml/rss.xml
RewriteRule ^xml/(.*)/(.*)/(.*)\.xml$ index.php?category=$1&filter=$2&slug=$3&format=xml [QSA,L]
RewriteRule ^xml/(.*)/(.*)\.xml$ index.php?category=$1&slug=$2&format=xml [QSA,L]
RewriteRule ^xml/(.*)\.xml$ index.php?slug=$1&format=xml [QSA,L]

# CSV (.csv)
# Sample 1: /csv/sales/report/jan.csv
# Sample 2: /csv/export/users.csv
# Sample 3: /csv/data.csv
RewriteRule ^csv/(.*)/(.*)/(.*)\.csv$ index.php?category=$1&filter=$2&slug=$3&format=csv [QSA,L]
RewriteRule ^csv/(.*)/(.*)\.csv$ index.php?category=$1&slug=$2&format=csv [QSA,L]
RewriteRule ^csv/(.*)\.csv$ index.php?slug=1&format=csv [QSA,L]


#webp (.webp)# WebP images
RewriteRule ^media/(.*)/(.*)$ media.php?project=$1&file=$2&format=media [QSA,L]
RewriteRule ^media/(.*)$ media.php?file=$1&format=media [QSA,L]
